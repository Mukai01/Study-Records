# 1. Githubのリポジトリ作成
* Githubでリポジトリを作成する

```sh
cd product-register
git config user.name "Mukai"
git config user.email "email@gmail.com"
git remote add origin <repo url>

git add .
git commit -m 'first commit'
git push origin master
```

# 2. Railsのテストを実行する
* product-registerの下のtest/controllersにテストコードが入っている

```sh
docker-compose up -d
# コンテナ2つがUpになっていることを確認
docker-compose ps
docker-compose exec web bash

# test実行
rails test
```

# 3. Travis CIをセットアップする
* https://app.travis-ci.com/　にアクセス
* GitHubでサインイン
* Product-registerフォルダに.travis.ymlを作成する

# 4. .travis.ymlにテストの流れを書く
テストを実行して、問題なければGitHubに上がる。

.travis.ymlに以下を記述する。
```yml
# 権限の設定
sudo: required

# Dockerを使う
services: docker

# コンテナを起動
before_install:
  # dockerが無いとこのあたりで環境構築しないといけない
  - docker-compose up --build -d
  - docker login -u "$HEROKU_USERNAME" -p "$HEROKU_API_KEY" registry.heroku.com

# DBを準備
script:
  - docker-compose exec --env 'RAILS_ENV=test' web rails db:create
  - docker-compose exec --env 'RAILS_ENV=test' web rails db:migrate
  # テスト実行
  - docker-compose exec --env 'RAILS_ENV=test' web rails test
```

またdocker-compose.ymlに以下を追加する
```yml
  db:
    environment:
    - 'POSTGRES_HOST_AUTH_METHOD=trust' # TravisCIでテストするために追加
```

